---
title: "How I Built a 4TB Encrypted Portable Pentest Drive"
date: 2025-04-14
layout: blog
draft: true
---

## Why Build This?

I wanted a single drive that could:

- Store my persistent **Kali VM**
- Archive all my **sessions, notes, and tools**
- Boot **a live Kali system** if needed
- Sync logs between **Windows, Linux, Mac**
- Stay **fully encrypted**, stealthy, and usable on the move

So I turned a 4TB external SSD into a **multi-partition hacker platform**.
Hereâ€™s how I built it.

---

## Partition Layout

| Partition | Format     | Purpose |
|-----------|------------|---------|
| `/dev/sdX1` | `exFAT`     | Shared storage for screenshots, notes, small loot |
| `/dev/sdX2` | `LUKS + ext4` | Encrypted storage: VMs, ops data, tools, backups |
| `/dev/sdX3` | Bootable (ext4) | Live Kali Linux â€” full bootable OS w/ persistence |

> ğŸ’¡ Optional: Add UEFI/BIOS partition if booting from older systems.

---

## Encrypting the Persistent Partition

### 1. Create the encrypted volume
```bash
cryptsetup luksFormat /dev/sdX2
```

### 2. Open and format it

cryptsetup luksOpen /dev/sdX2 kaliusb
mkfs.ext4 /dev/mapper/kaliusb

### 3. Mount it

mkdir /mnt/kaliusb
mount /dev/mapper/kaliusb /mnt/kaliusb

## Keyfile-Based Unlocking

You can create a keyfile on each trusted machine to unlock the drive without typing a password.

dd if=/dev/urandom of=/root/.secret/kali_usb.key bs=1024 count=4
chmod 600 /root/.secret/kali_usb.key

cryptsetup luksAddKey /dev/sdX2 /root/.secret/kali_usb.key

Now add this to /etc/crypttab:

kaliusb UUID=<your-luks-uuid> /root/.secret/kali_usb.key luks

And /etc/fstab:

/dev/mapper/kaliusb /mnt/kaliusb ext4 defaults 0 2

- [x] Now the encrypted partition auto-mounts only on trusted devices. If the driveâ€™s lost, itâ€™s useless without your internal keyfile.

## Hosting My Kali VM

I keep my .vbox, .vdi, and session folders directly on the encrypted partition:

/mnt/kaliusb/
â”œâ”€â”€ vm/
â”‚   â””â”€â”€ Kali-Ghost.vbox
â”œâ”€â”€ ops/
â”‚   â”œâ”€â”€ sessions/
â”‚   â””â”€â”€ tools/
â””â”€â”€ backups/

This means:
* My VM is portable
* All sessions are persistent, encrypted
* No trace remains on the host

## Bootable Partition (Live Kali)

I made /dev/sdX3 bootable with Kali Live + persistence:

* Download Kali ISO
* Use dd or BalenaEtcher to write to /dev/sdX3
* Create a persistence.conf file inside /persistence folder
* Boot with:

Live system (persistence, encrypted)

* Works on any x86 machine. Bring your OS with you.

## Shared exFAT Partition

For compatibility:

* /dev/sdX1 is exFAT
* Mountable on Linux, Windows, Mac
* Use for low-risk transfer files (e.g., screenshots, drop reports, blog drafts)

## Automating It All

I created two scripts on my host:
### mount-kaliusb.sh

Mounts the encrypted partition if detected.

```bash
#!/bin/bash
cryptsetup luksOpen /dev/sdX2 kaliusb --key-file /root/.secret/kali_usb.key
mount /dev/mapper/kaliusb /mnt/kaliusb
```

### eject-kaliusb.sh

Unmounts and locks the partition safely.

```bash
#!/bin/bash
umount /mnt/kaliusb
cryptsetup luksClose kaliusb
```

## Optional: Archive + Backup

At the end of a session, I can run:

```bash
tar -czf session_$(date +%F).tar.gz /mnt/kaliusb/ops/sessions/latest
gpg -c session_2025-04-14.tar.gz
```

And upload the encrypted .gpg file to ProtonDrive if I want an offsite copy.

## Why This Setup Works

- [x] Portable across machines
- [x] Fully encrypted, stealthy, and isolated
- [x] Bootable when needed
- [x] Compatible with Linux, Mac, Windows
- [x] Nothing decrypts unless I unlock it

I donâ€™t need a cloud VM.
I donâ€™t need a â€œplatform.â€
I just need my drive and a USB port.

## Final Thought

If you want to carry your entire pentest world on a drive â€” not just tools, but your identity, session history, and kill switch â€” this is the cleanest way to do it.

Let them keep their cloud labs.
Iâ€™ve got a 4TB ghost system that follows me only when I want it to.
